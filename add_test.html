<html><head><base href="https://example.com/"></base>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>台語學習問題管理系統 - 出題頁面</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: #333;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: #f0f0f0;
  }
  h1 {
    color: #2c3e50;
    text-align: center;
  }
  form {
    background-color: #ffffff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
  }
  input[type="text"], input[type="url"], select, textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-sizing: border-box;
  }
  button {
    background-color: #3498db;
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    margin-top: 20px;
  }
  button:hover {
    background-color: #2980b9;
  }
  #message {
    margin-top: 20px;
    padding: 10px;
    border-radius: 4px;
  }
  .success {
    background-color: #d4edda;
    border-color: #c3e6cb;
    color: #155724;
  }
  .error {
    background-color: #f8d7da;
    border-color: #f5c6cb;
    color: #721c24;
  }
</style>
</head>
<body>
  <h1>台語學習問題管理系統 - 出題頁面</h1>
  
  <form id="questionForm">
    <label for="type">問題類型：</label>
    <select id="type" name="type" required>
      <option value="text">文字題</option>
      <option value="audio">音檔題</option>
    </select>

    <label for="question">問題內容：</label>
    <textarea id="question" name="question" rows="3" required></textarea>

    <label for="option1">選項 1：</label>
    <input type="text" id="option1" name="option1" required>

    <label for="option2">選項 2：</label>
    <input type="text" id="option2" name="option2" required>

    <label for="option3">選項 3：</label>
    <input type="text" id="option3" name="option3" required>

    <label for="option4">選項 4：</label>
    <input type="text" id="option4" name="option4" required>

    <label for="correctAnswer">正確答案：</label>
    <select id="correctAnswer" name="correctAnswer" required>
      <option value="">請選擇正確答案</option>
      <option value="1">選項 1</option>
      <option value="2">選項 2</option>
      <option value="3">選項 3</option>
      <option value="4">選項 4</option>
    </select>

    <label for="audioUrl">音檔 URL（僅限音檔題）：</label>
    <input type="url" id="audioUrl" name="audioUrl">

    <button type="submit">提交問題</button>
  </form>

  <div id="message"></div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbypXznI16tnIC5FRV9oKtRESwqsVF9Nnj2qaiwkOhxidWSCEey7WJ6KVY9sjkPUg8svxg/exec';

    document.getElementById('questionForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const formData = new FormData(this);
      const questionData = {
        type: formData.get('type'),
        question: formData.get('question'),
        options: [
          formData.get('option1'),
          formData.get('option2'),
          formData.get('option3'),
          formData.get('option4')
        ],
        correctAnswer: formData.get(`option${formData.get('correctAnswer')}`),
        audioUrl: formData.get('audioUrl') || ''
      };

      const messageDiv = document.getElementById('message');
      messageDiv.textContent = '正在提交問題...';
      messageDiv.className = '';

      fetch(SCRIPT_URL + '?action=addQuestion', {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(questionData),
      })
      .then(response => {
        // 由於使用 'no-cors' 模式，我們無法讀取響應內容
        // 但我們可以檢查響應狀態是否為 0（這是 'no-cors' 模式的預期行為）
        if (response.status === 0) {
          messageDiv.textContent = '問題新增成功！（注意：由於跨域限制，無法確認服務器的實際響應）';
          messageDiv.className = 'success';
          document.getElementById('questionForm').reset();
        } else {
          throw new Error('提交失敗，請檢查網絡連接並重試。');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        messageDiv.textContent = '發生錯誤，請稍後再試。錯誤詳情：' + error.message;
        messageDiv.className = 'error';
      });
    });

    // 根據問題類型顯示/隱藏音檔 URL 輸入框
    document.getElementById('type').addEventListener('change', function() {
      const audioUrlField = document.getElementById('audioUrl');
      audioUrlField.style.display = this.value === 'audio' ? 'block' : 'none';
    });
  </script>
</body>
</html>
